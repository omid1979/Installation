Keepalive

keepalive

\[root@server1 ~\]# yum install -y keepalived

\[root@server1 ~\]# keepalived --version  
Keepalived v2.0.10 (11/12,2018)

\[root@server1 ~\]# systemctl status keepalived  
keepalived.service - LVS and VRRP High Availability Monitor  
Loaded: loaded (/usr/lib/systemd/system/keepalived.service; disabled; vendor preset: disab  
Active: inactive (dead)

# Install prerequisites

yum install -y gcc openssl-devel

# Download the latest version of the code. Be sure to check the downloads page for the most recent version:https://www.keepalived.org/download.html

\[root@localhost ~\]# wget https://www.keepalived.org/software/keepalived-2.0.20.tar.gz

# Extract the code

\[root@localhost ~\]# tar -xf keepalived-2.0.20.tar.gz

# Run the configure scripts

\[root@localhost ~\]# cd keepalived-2.0.20  
\[root@localhost keepalived-2.0.20\]# ./configure

# Build and install keepalived

\[root@localhost keepalived-2.0.20\]# make  
\[root@localhost keepalived-2.0.20\]# make install

# Test your installation

\[root@localhost keepalived-2.0.20\]# keepalived --version  
Keepalived v2.0.20 (01/22,2020)

<img src=":/de670644c4614798870b26fe3762aaf2" alt="Picture1_2.png" width="381" height="204">

https://www.redhat.com/sysadmin/sites/default/files/styles/embed_large/public/2020-03/Picture1_2.png?itok=rV2lxEnz

**Server 1 configuration:**

server1# cat /etc/keepalived/keepalived.conf  
vrrp_instance VI_1 {  
state MASTER  
interface eth0  
virtual_router_id 51  
priority 255  
advert_int 1  
authentication {  
auth_type PASS  
auth_pass 12345  
}  
virtual_ipaddress {  
192.168.122.200/24  
}  
}

**Server 2 configuration:**

server2# cat /etc/keepalived/keepalived.conf  
vrrp_instance VI_1 {

```
    state BACKUP
    interface eth0
    virtual_router_id 51
    priority 254
    advert_int 1
    authentication {
          auth_type PASS
          auth_pass 12345
    }
    virtual_ipaddress {
          192.168.122.200/24
    }
```

}

\=================  
**Monitoring VRRP traffic**  
server1# tcpdump proto 112

id: e0b8a4ea204d4af28a3636c4c6fa4893
parent_id: 9051567a85b34643b4e0252a8fdf0ac0
created_time: 2024-08-11T12:49:08.545Z
updated_time: 2024-08-13T08:28:39.493Z
is_conflict: 0
latitude: 35.68919750
longitude: 51.38897360
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2024-08-11T12:49:08.545Z
user_updated_time: 2024-08-13T08:28:39.493Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
deleted_time: 0
type_: 1