Log User's Commaand ( audit )


command-log  

1-vim ~/.bashrc
export PROMPT_COMMAND='history -a >(logger -p local2.info -t "$USER[$PWD] $SSH_CONNECTION")'

*********if you want all users will be created in the future have this option, you shoul copy in this direction***********
vim / etc/skel/.bashrc
export PROMPT_COMMAND='history -a >(logger -p local2.info -t "$USER[$PWD] $SSH_CONNECTION")'
*********************************************************************************************************************************

*********if you have multuple users, you should switch to them and edit their ~/.bashrc file***************************
su - j.fatehi
vim ~/.bashrc
export PROMPT_COMMAND='history -a >(logger -p local2.info -t "$USER[$PWD] $SSH_CONNECTION")'
********************************************************************************************************************************

2-source /etc/bashrc

3-vim /etc/rsyslog.conf
local2.info                                             /var/log/history_cmd.log

4-systemctl restart rsyslog

5-cat /var/log/history_cmd.log


**********if you want to alert users to know about logged commands you can add some text in banner***********
1-vim /etc/isuuue.net
!!!NOTICE THAT ALL YOUR COMMANDS WILL BE LOGGED!!!

2-vim /etc/ssh/sshd.config
Banner /etc/issue.net

3-systemctl restart sshd

id: 6623826268424674b31e97453bf7dc64
parent_id: 9051567a85b34643b4e0252a8fdf0ac0
created_time: 2024-08-26T05:07:09.990Z
updated_time: 2024-08-26T05:08:49.214Z
is_conflict: 0
latitude: 35.68919750
longitude: 51.38897360
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2024-08-26T05:07:09.990Z
user_updated_time: 2024-08-26T05:08:49.214Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
deleted_time: 0
type_: 1