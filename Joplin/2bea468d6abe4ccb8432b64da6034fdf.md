audit

**\[root@PLVA4137:~# cat /etc/sudoers.d/linuxadm**  
Cmnd_Alias NSHELLS = /bin/sh,/bin/bash  
Cmnd_Alias NSU = /bin/su  
Cmnd_Alias NVISUDO = /usr/sbin/visudo  
#User_Alias USERS = test1,test2,test3  
%linuxadm ALL=(ALL) NOPASSWD:ALL,!NSHELLS,!NSU,!NVISUDO  
Defaults log_host,log_year,logfile="/var/log/sudo.log"

&nbsp;

\========================================

**root@plva3026:~# vi /etc/ssh/sshd_config**

\# BEGIN ANSIBLE MANAGED BLOCK  
Match User \*,!root  
ForceCommand /usr/bin/bash-linux  
\# END ANSIBLE MANAGED BLOCK

&nbsp;

**\[root@PLVA4137:~# cat /usr/bin/bash-linux**

#!/bin/bash  
if \[\[ -n $SSH_ORIGINAL_COMMAND \]\] # command given, so run it  
then

&nbsp; exec /bin/bash -rc 'logger -p local6.debug "bash\[$$\]" user=$USER ip=$SSH_CONNECTION originaluser=$USER exitcode="remote" "command=$SSH_ORIGINAL_COMMAND";$SSH_ORIGINAL_COMMAND'  
else # no command, so interactive login shell  
     exec bash -il  
fi

&nbsp;

&nbsp;/etc/rsyslog

local6.debug @172.29.133.66:514  
local4.\* @172.29.132.19:514

&nbsp;

&nbsp;

id: 2bea468d6abe4ccb8432b64da6034fdf
parent_id: 2700abf6b5f5483881bd8b53cf358310
created_time: 2024-08-20T05:59:48.423Z
updated_time: 2024-08-20T06:25:51.802Z
is_conflict: 0
latitude: 35.68919750
longitude: 51.38897360
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2024-08-20T05:59:48.423Z
user_updated_time: 2024-08-20T06:25:51.802Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
deleted_time: 0
type_: 1