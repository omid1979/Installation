مفهوم کانتینر

سلام. امروز می‌خوام درباره نحوه ساخته شدن کانتینرها 🐳🐋 صحبت کنم. 

 سناریویی رو تصور بکنید که در اون یک ماشین لینوکسی داریم و علی و رضا به این ماشین وصل شدن و با شل دارن باهاش کار می‌کنن. 
نکته اولی که وجود داره اینه که علی و رضا میتونن فایل سیستم همدیگه رو ببینن و برای همدیگه مشکلاتی ایجاد کنن. مثلا فایل‌های همدیگه رو پاک کنن.

 👈: دستور اول، CHROOT: این دستور این امکان رو میده که پراسس فعلی، دایرکتوری بالاتر از خودش رو نبینه. برای هر دو نفر، یک دایرکتوری مشخص میکنیم 
و Process هرکدوم رو به اون دایرکتوری CHROOT میکنیم. مثلا با shell علی دستور CHROOT رو برای یک مسیر اجرا می‌کنیم و حالا علی وارد اون مسیر میشه و 
هرچقدر هم بخواد از اون پوشه دربیاد، امکانپذیر نیست. در واقع دایرکتوری رو برای هردو ایزوله کردیم. 

اما درسته که الان فایل سیستم این دو process از هم جدا شده ولی کماکان این دو process می‌تونن همدیگرو ببینن. اگر یکی دستور ps aux رو اجرا کنه 
می‌تونه PID اون یکی رو ببینه و دستور kill رو برای process اون یکی اجرا کنه. 

👈: دستور دوم، UNSHARE: دستور UNSHARE میاد و namespace هارو برای Process اینها جدا می‌کنه. مثلا یکی از namespace ها برای process هست و بعد از
این دستور اتفاقی که میوفته این هست که این دونفر حتی process های همدیگه رو نمیتونن ببینن و حتی اگر هر دو processی با شناسه ۱ داشته باشن، نمی‌تونن
اون رو kill کنن. namespace های متفاوتی هم وجود داره که من زیاد بلد نیستم و همینقدر بلدم .

حالا همه چیز رو جدا کردیم ولی یک مشکل دیگه هم هست. اگر علی یک کد فاجعه بنویسه که مصرف حافظه، CPU یا هر ریسورس دیگه ای رو تا حد زیادی اشغال کنه
و چیزی به رضا نرسه چی؟! اینجا باید چیکار کرد؟!

👈: دستور سوم، CGROUP: با این کد میتونیم مشخص کنیم یک سرویس (که میتونه مجموعه‌ای از process ها باشه)، چقدر از منابع رو می‌تونه داشته باشه. 
ما میتونیم محدود کنیم که مثلا یک process فقط ۲۰ درصد CPU بگیره و از اون بیشتر مصرف نکنه 


🎉 حالا ما کانتینر داریم. process هایی که هم از بابت filesystem، هم از بابت namespace و هم از بابت مصرف ریسورس، از هم دیگه ایزوله هستن. 🐳🐋.

id: cedd766c9f8c4057895daa6b54f2b537
parent_id: 6df7a667a12643adb75aab7021873500
created_time: 2024-08-18T04:38:43.463Z
updated_time: 2024-08-18T05:24:07.177Z
is_conflict: 0
latitude: 35.68919750
longitude: 51.38897360
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2024-08-18T04:38:43.463Z
user_updated_time: 2024-08-18T05:24:07.177Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
deleted_time: 0
type_: 1